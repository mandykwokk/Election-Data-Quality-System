{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mandy\\\\IdeaProjects\\\\DataQuality-Frontend\\\\src\\\\components\\\\map\\\\RightPanel\\\\PanelCharts\\\\Election.js\";\nimport React, { useContext, useState } from 'react';\nimport { Divider, Popover, Typography, Table, Button, Menu, Dropdown } from 'antd';\nimport Slider from \"react-slick\";\nimport { Pie } from 'react-chartjs-2';\nimport * as Constants from 'constants/constants';\nimport HistoryContext from 'contexts/HistoryContext';\nimport StateContext from 'contexts/StateContext';\nimport DistrictContext from 'contexts/DistrictContext';\nimport { message } from 'antd';\nimport { DownOutlined, CalendarOutlined } from '@ant-design/icons';\nimport PrecinctRequester from 'requesters/PrecinctRequester';\nconst precinctRequester = new PrecinctRequester();\nconst {\n  Paragraph\n} = Typography;\nexport default function Election(props) {\n  const handleAddHistory = useContext(HistoryContext);\n  const [rerender, setRerender] = useState(false);\n  const [data, setData] = useState(props.data);\n  const [selectedRegion, setSelectedRegion] = useState(props.name);\n  const [selectedElection, setSelectedElection] = useState(Constants.ELECTIONS[0]);\n  const selectedState = useContext(StateContext);\n  const selectedCd = useContext(DistrictContext);\n  var originalData;\n  const columns = [{\n    title: 'Party',\n    dataIndex: 'party',\n    key: 'party'\n  }, {\n    title: 'Votes',\n    dataIndex: 'votes',\n    key: 'votes',\n    render: (votes, record, index) => props.editable ? React.createElement(Paragraph, {\n      editable: {\n        onChange: value => onChange(value, index)\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 37\n      },\n      __self: this\n    }, votes.toLocaleString() + \"\") : React.createElement(Paragraph, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 39\n      },\n      __self: this\n    }, votes.toLocaleString() + \"\"),\n    width: 100\n  }, {\n    title: 'Percent',\n    dataIndex: 'percent',\n    key: 'percent'\n  }];\n\n  function getData() {\n    if (Constants.STATES.includes(selectedRegion) && selectedRegion !== selectedState.name) {\n      setData(selectedState.elections);\n      setSelectedRegion(selectedState.name);\n    }\n\n    let displayData = [];\n    let sum = 0;\n    let index = Constants.ELECTIONS.indexOf(selectedElection);\n\n    for (let i in data) {\n      if (i === Constants.ELECTIONS_ENUM[index]) {\n        displayData.push(data[i][Constants.PARTIES_ENUM[0]]);\n        displayData.push(data[i][Constants.PARTIES_ENUM[1]]);\n        sum += Number(data[i][Constants.PARTIES_ENUM[0]]);\n        sum += Number(data[i][Constants.PARTIES_ENUM[1]]);\n      }\n    }\n\n    displayData = displayData.map((item, index) => {\n      return {\n        key: index,\n        party: Constants.PARTIES[index],\n        votes: item,\n        percent: (item / sum * 100).toFixed(1)\n      };\n    });\n    return displayData;\n  }\n\n  function onChange(value, index) {\n    let elecionIndex = Constants.ELECTIONS.indexOf(selectedElection);\n    value = value.replace(\",\", '');\n\n    if (isNaN(value) || value.includes(\".\") || value.includes(\"-\") || value === \"\") {\n      message.warn(\"Please enter a valid number\");\n      return;\n    }\n\n    value = parseInt(value);\n    originalData = JSON.parse(JSON.stringify(data));\n    data[Constants.ELECTIONS_ENUM[elecionIndex]][[Constants.PARTIES_ENUM[index]]] = value; //frontend data changed\n\n    Object.entries(selectedCd.elections[Constants.ELECTIONS_ENUM[elecionIndex]]).forEach(([key, value]) => {\n      selectedCd.elections[Constants.ELECTIONS_ENUM[elecionIndex]][key] += data[Constants.ELECTIONS_ENUM[elecionIndex]][key] - originalData[Constants.ELECTIONS_ENUM[elecionIndex]][key];\n    });\n    Object.entries(selectedState.elections[Constants.ELECTIONS_ENUM[elecionIndex]]).forEach(([key, value]) => {\n      selectedState.elections[Constants.ELECTIONS_ENUM[elecionIndex]][key] += data[Constants.ELECTIONS_ENUM[elecionIndex]][key] - originalData[Constants.ELECTIONS_ENUM[elecionIndex]][key];\n    });\n\n    if (!isNaN(selectedRegion)) {\n      //precinct\n      if (precinctRequester.updateElection(Number(selectedRegion), data, selectedCd.elections, selectedState.elections)) {\n        message.success(\"Election data saved\");\n        props.data[Constants.ELECTIONS_ENUM[elecionIndex]][[Constants.PARTIES_ENUM[index]]] = value;\n        handleAddHistory({\n          description: \"Changed \" + Constants.ELECTIONS[elecionIndex] + \" \" + Constants.PARTIES[index] + \" election from \" + originalData[Constants.ELECTIONS_ENUM[elecionIndex]][[Constants.PARTIES_ENUM[index]]].toLocaleString() + \" to \" + value.toLocaleString() + \". \"\n        }, props.region);\n      }\n    }\n\n    setRerender(!rerender);\n  }\n\n  return React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, React.createElement(Divider, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }), React.createElement(\"h1\", {\n    className: \"chartHeader\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, \"Election Data\"), React.createElement(Dropdown, {\n    overlay: React.createElement(Menu, {\n      onClick: ({\n        key\n      }) => setSelectedElection(key),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, Constants.ELECTIONS.map(election => {\n      return React.createElement(Menu.Item, {\n        key: election,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, React.createElement(CalendarOutlined, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }), \" \", election);\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"electionDiv\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }, React.createElement(Button, {\n    type: \"primary\" //icon={<CalendarOutlined />}\n    ,\n    shape: \"round\",\n    style: {\n      borderRadius: '5px',\n      height: '24.5px',\n      lineHeight: '1em',\n      paddingLeft: '10px',\n      paddingRight: '7px'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, selectedElection, \" \", React.createElement(DownOutlined, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  })))), React.createElement(Popover, {\n    placement: \"topRight\",\n    title: \"Source of Data\",\n    content: selectedState && selectedState.name === \"OH\" ? React.createElement(React.Fragment, null, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, \"Ohio State of secretary\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, \"https://www.sos.state.oh.us/elections/election-results-and-data\")) : React.createElement(React.Fragment, null, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, \"Open Elections Project\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, \"http://openelections.net/\")),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    className: \"sourceText\",\n    style: {\n      marginTop: '-23px'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"sourceBg\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, \"Source of Data\"))), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }), React.createElement(Slider, {\n    arrows: false,\n    dots: true,\n    infinite: true,\n    speed: 500,\n    slidesToShow: 1,\n    slidesToScroll: 1,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, React.createElement(Pie, {\n    data: {\n      labels: Constants.PARTIES,\n      datasets: [{\n        data: getData().map(item => item.votes),\n        backgroundColor: ['#36A2EB', '#FF6384', '#B2EB70', '#FFCE56'],\n        hoverBackgroundColor: ['#36A2EB', '#FF6384', '#B2EB70', '#FFCE56']\n      }]\n    },\n    borderWidth: 100,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }), React.createElement(Table, {\n    columns: columns,\n    dataSource: getData(),\n    pagination: false,\n    size: 'small',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  })));\n}","map":{"version":3,"sources":["C:/Users/mandy/IdeaProjects/DataQuality-Frontend/src/components/map/RightPanel/PanelCharts/Election.js"],"names":["React","useContext","useState","Divider","Popover","Typography","Table","Button","Menu","Dropdown","Slider","Pie","Constants","HistoryContext","StateContext","DistrictContext","message","DownOutlined","CalendarOutlined","PrecinctRequester","precinctRequester","Paragraph","Election","props","handleAddHistory","rerender","setRerender","data","setData","selectedRegion","setSelectedRegion","name","selectedElection","setSelectedElection","ELECTIONS","selectedState","selectedCd","originalData","columns","title","dataIndex","key","render","votes","record","index","editable","onChange","value","toLocaleString","width","getData","STATES","includes","elections","displayData","sum","indexOf","i","ELECTIONS_ENUM","push","PARTIES_ENUM","Number","map","item","party","PARTIES","percent","toFixed","elecionIndex","replace","isNaN","warn","parseInt","JSON","parse","stringify","Object","entries","forEach","updateElection","success","description","region","election","borderRadius","height","lineHeight","paddingLeft","paddingRight","marginTop","labels","datasets","backgroundColor","hoverBackgroundColor"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from 'react';\r\nimport { Divider, Popover, Typography, Table ,  Button, Menu, Dropdown} from 'antd';\r\nimport Slider from \"react-slick\";\r\nimport { Pie } from 'react-chartjs-2';\r\nimport * as Constants from 'constants/constants';\r\nimport HistoryContext from 'contexts/HistoryContext';\r\nimport StateContext from 'contexts/StateContext';\r\nimport DistrictContext from 'contexts/DistrictContext';\r\nimport { message } from 'antd';\r\nimport {DownOutlined, CalendarOutlined} from '@ant-design/icons';\r\nimport PrecinctRequester from 'requesters/PrecinctRequester';\r\nconst precinctRequester = new PrecinctRequester();\r\n\r\nconst { Paragraph } = Typography;\r\n\r\nexport default function Election(props) {\r\n    const handleAddHistory = useContext(HistoryContext);\r\n    const [rerender, setRerender] = useState(false);\r\n    const [data, setData] = useState(props.data);\r\n    const [selectedRegion, setSelectedRegion] = useState(props.name);\r\n    const [selectedElection, setSelectedElection] = useState(Constants.ELECTIONS[0]);\r\n    const selectedState = useContext(StateContext);\r\n    const selectedCd = useContext(DistrictContext);\r\n    var originalData;\r\n    const columns = [\r\n        {\r\n            title: 'Party',\r\n            dataIndex: 'party',\r\n            key: 'party'\r\n        },\r\n        {\r\n            title: 'Votes',\r\n            dataIndex: 'votes',\r\n            key: 'votes',\r\n            render: (votes, record, index) => (\r\n                props.editable?\r\n                    <Paragraph editable={{ onChange: value => onChange(value, index)}}>{votes.toLocaleString()+\"\"}</Paragraph>\r\n                :\r\n                    <Paragraph>{votes.toLocaleString()+\"\"}</Paragraph>\r\n                ),\r\n            width: 100,\r\n        },\r\n        {\r\n            title: 'Percent',\r\n            dataIndex: 'percent',\r\n            key: 'percent',\r\n        }\r\n    ];\r\n\r\n    function getData() {\r\n        if(Constants.STATES.includes(selectedRegion)&&selectedRegion!==selectedState.name){\r\n           setData(selectedState.elections);\r\n           setSelectedRegion(selectedState.name);\r\n       }\r\n        let displayData = [];\r\n        let sum = 0;\r\n        let index = Constants.ELECTIONS.indexOf(selectedElection);\r\n        for(let i in data) {\r\n            if(i===Constants.ELECTIONS_ENUM[index]){\r\n                displayData.push(data[i][Constants.PARTIES_ENUM[0]]);\r\n                displayData.push(data[i][Constants.PARTIES_ENUM[1]]);\r\n                sum += Number(data[i][Constants.PARTIES_ENUM[0]]);\r\n                sum += Number(data[i][Constants.PARTIES_ENUM[1]]);\r\n            }\r\n        }\r\n        displayData = displayData.map((item, index) => {\r\n            return {\r\n                key: index,\r\n                party: Constants.PARTIES[index],\r\n                votes: item,\r\n                percent: (item/sum*100).toFixed(1)\r\n            }\r\n        });\r\n        return displayData;\r\n    }\r\n\r\n    function onChange(value, index) {\r\n        let elecionIndex = Constants.ELECTIONS.indexOf(selectedElection);\r\n        value = value.replace(\",\", '');\r\n        if(isNaN(value)||value.includes(\".\")||value.includes(\"-\")||value===\"\"){\r\n            message.warn(\"Please enter a valid number\");\r\n            return;\r\n        }\r\n        value = parseInt(value);\r\n        originalData = JSON.parse(JSON.stringify(data));\r\n        data[Constants.ELECTIONS_ENUM[elecionIndex]][[Constants.PARTIES_ENUM[index]]] = value;//frontend data changed\r\n        Object.entries(selectedCd.elections[Constants.ELECTIONS_ENUM[elecionIndex]]).forEach(([key, value]) => {\r\n            selectedCd.elections[Constants.ELECTIONS_ENUM[elecionIndex]][key] += (data[Constants.ELECTIONS_ENUM[elecionIndex]][key]-originalData[Constants.ELECTIONS_ENUM[elecionIndex]][key]);\r\n        });\r\n        Object.entries(selectedState.elections[Constants.ELECTIONS_ENUM[elecionIndex]]).forEach(([key, value]) => {\r\n            selectedState.elections[Constants.ELECTIONS_ENUM[elecionIndex]][key] += (data[Constants.ELECTIONS_ENUM[elecionIndex]][key]-originalData[Constants.ELECTIONS_ENUM[elecionIndex]][key]);\r\n        });\r\n        if(!isNaN(selectedRegion)){//precinct\r\n            if(precinctRequester.updateElection(Number(selectedRegion), data,selectedCd.elections, selectedState.elections)){\r\n                message.success(\"Election data saved\");\r\n                props.data[Constants.ELECTIONS_ENUM[elecionIndex]][[Constants.PARTIES_ENUM[index]]] = value;\r\n                handleAddHistory({description:\"Changed \"+Constants.ELECTIONS[elecionIndex]+\" \"+ Constants.PARTIES[index]\r\n                + \" election from \" + originalData[Constants.ELECTIONS_ENUM[elecionIndex]][[Constants.PARTIES_ENUM[index]]].toLocaleString() + \" to \" + value.toLocaleString() + \". \"},props.region);\r\n            }\r\n        }\r\n        setRerender(!rerender);\r\n    }\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <Divider />\r\n            <h1 className=\"chartHeader\">Election Data</h1>\r\n            <Dropdown\r\n                overlay={\r\n                    <Menu onClick={({ key }) => setSelectedElection(key)}>\r\n                        {\r\n                            Constants.ELECTIONS.map((election) => {\r\n                                return (\r\n                                    <Menu.Item key={election}>\r\n                                        <CalendarOutlined /> {election}\r\n                                    </Menu.Item>\r\n                                );\r\n                            }\r\n                            )\r\n                        }\r\n                    </Menu>\r\n                }\r\n            >\r\n                <div className=\"electionDiv\">\r\n                    <Button\r\n                        type=\"primary\"\r\n                        //icon={<CalendarOutlined />}\r\n                        shape=\"round\"\r\n                        style={{borderRadius: '5px', height: '24.5px', lineHeight: '1em', paddingLeft: '10px', paddingRight: '7px'}}\r\n                    >\r\n                        {selectedElection} <DownOutlined />\r\n                    </Button>\r\n                </div>\r\n            </Dropdown>\r\n            <Popover\r\n                placement=\"topRight\" \r\n                title={\"Source of Data\"}\r\n            content=\r\n            {\r\n                selectedState && selectedState.name === \"OH\" ?\r\n                <>\r\n                    <p>Ohio State of secretary</p>\r\n                    <p>https://www.sos.state.oh.us/elections/election-results-and-data</p>\r\n                </>\r\n                :\r\n                <>\r\n                    <p>Open Elections Project</p>\r\n                    <p>http://openelections.net/</p>\r\n                </>\r\n            }\r\n            >\r\n                <p className=\"sourceText\" style={{marginTop: '-23px'}}><span className=\"sourceBg\">Source of Data</span></p>\r\n            </Popover>\r\n            <br />\r\n            <Slider \r\n                arrows={false}\r\n                dots={true}\r\n                infinite={true}\r\n                speed={500}\r\n                slidesToShow={1}\r\n                slidesToScroll={1}\r\n            >\r\n                <Pie \r\n                    data={{\r\n                        labels: Constants.PARTIES,\r\n                        datasets: [{\r\n                            data: getData().map(item => item.votes),\r\n                            backgroundColor: [\r\n                                '#36A2EB',\r\n                                '#FF6384',\r\n                                '#B2EB70',\r\n                                '#FFCE56',\r\n                    \r\n                            ],\r\n                            hoverBackgroundColor: [\r\n                                '#36A2EB',\r\n                                '#FF6384',\r\n                                '#B2EB70',\r\n                                '#FFCE56',\r\n                            ]\r\n                        }]\r\n                    }\r\n                    }\r\n                    borderWidth = {100}\r\n                />\r\n                <Table\r\n                    columns={columns}\r\n                    dataSource={getData()}\r\n                    pagination={false}\r\n                    size={'small'}\r\n                />\r\n            </Slider>\r\n        </React.Fragment>\r\n    );\r\n}"]},"metadata":{},"sourceType":"module"}